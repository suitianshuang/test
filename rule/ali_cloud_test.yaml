# rule/sample_rule.yaml
rule:
  name: "阿里云-RAM-RAM User拥有大权限但无调用来源ACL"
  description: |
    拥有 AliyunRAMFullAccess、AdministratorAccess权限的RAM User没有设置调用来源ACL
  level: "high"  # 可选字段：规则严重等级
  category: "身份安全"
  advice: "设置访问控制ACL"
  link: "https://example.com/sql-injection-prevention"
  rego: |
    package ram_user_with_high_risk_access_has_no_acl
    import rego.v1
  
    default risk := false
    risk if {
      exist_AccessKey
      exist_Policies != null
      without_network_acl
      tmp_white
    }
      tmp_white if {
        not input.UserDetail.UserName in data.control_user_name_list.ram_user_name
    }
